<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Spotify Auth - One File</title>
</head>
<body>
  <button onclick="login()">Login with Spotify</button>
  <div id="user"></div>

  <script>
    const client_id = 'b2bee85f176549668d85bc8c6d9c232c'; // YOUR ID
    const redirect_uri = 'http://127.0.0.1:5500'; // OR wherever you're hosting
    const scopes = 'user-read-private user-read-email';

    function login() {
      const auth_url = 'https://accounts.spotify.com/authorize' +
        `?response_type=token` +
        `&client_id=${client_id}` +
        `&scope=${encodeURIComponent(scopes)}` +
        `&redirect_uri=${encodeURIComponent(redirect_uri)}`;

      window.location.href = auth_url;
    }

    window.onload = () => {
      if (window.location.hash) {
        const hash = window.location.hash.substring(1);
        const params = new URLSearchParams(hash);
        const token = params.get('access_token');

        if (token) {
          fetch('https://api.spotify.com/v1/me', {
            headers: { 'Authorization': 'Bearer ' + token }
          })
          .then(res => res.json())
          .then(data => {
            document.getElementById('user').innerHTML = `
              <h2>ðŸŽ§ Logged In</h2>
              <p><b>Name:</b> ${data.display_name}</p>
              <p><b>Email:</b> ${data.email}</p>
              <p><b>Country:</b> ${data.country}</p>
              <p><b>ID:</b> ${data.id}</p>
            `;
          })
          .catch(err => {
            document.getElementById('user').innerHTML = `<p style="color:red;">Error: ${err.message}</p>`;
          });
        }
      }
    };
  </script>
</body>
</html>
